# Access Control - Unprotected Admin Functionality with Unpredictable URL

## Overview

**Lab:** Unprotected admin functionality with unpredictable URL  
**Platform:** PortSwigger Web Security Academy  
**Difficulty:** APPRENTICE  
**Category:** Access Control

## Objective

This lab has an unprotected admin panel. It's located at an unpredictable location, but the location is disclosed somewhere in the application.

To solve the lab, access the admin panel and use it to delete the user carlos.

## Reconnaissance

### Initial Analysis

The application contains an admin panel at an unpredictable URL. Unlike the previous lab, the admin panel location is not in `robots.txt`, but it is disclosed somewhere in the application's requests or responses.

### Target Endpoint

```
https://0acd000a044e548a82f116a70093005e.web-security-academy.net/
```

## Exploitation

### Step 1: Intercept Requests with Burp Suite

I used Burp Suite to intercept and analyze the application's HTTP requests. By monitoring the traffic, I could identify any unusual or admin-related URLs being called by the application.

### Step 2: Discover Admin URL

While analyzing the intercepted requests and responses, I found JavaScript code that revealed the admin panel URL. The code contained a reference to `/admin-js3b7t`:

```javascript
var adminPanelTag = document.createElement("a");
adminPanelTag.setAttribute("href", "/admin-js3b7t");
adminPanelTag.innerText = "Admin panel";
```

Even though the URL appeared unusual, I attempted to access it directly.

**Admin Panel URL:**

```
https://0acd000a044e548a82f116a70093005e.web-security-academy.net/admin-js3b7t
```

The admin panel was accessible without any authentication or authorization checks, confirming the unprotected functionality vulnerability.

### Step 3: Delete User Carlos

Once inside the admin panel, I could see the list of users. I deleted the user `carlos` to complete the lab objective.

## âœ… Solution

### Exploit Steps

1. Intercept application requests using Burp Suite
2. Identify the admin URL being called in the requests
3. Navigate directly to the discovered admin panel URL
4. Delete the user `carlos` from the admin interface

### Verification

After deleting the user `carlos` from the unprotected admin panel, the lab was successfully completed. This demonstrates that even when admin panels are located at unpredictable URLs, they can be discovered through traffic analysis, and the application failed to implement proper access controls.

## Screenshots

![JavaScript code revealing the /admin-js3b7t URL in the response](./screenshots/image2.1.png)

![Admin panel page showing the user management interface](./screenshots/image2.png)

## Key Takeaways

- Admin panels at unpredictable URLs can still be discovered through traffic interception and analysis
- Tools like Burp Suite are essential for identifying hidden or unusual endpoints
- Administrative functionality must be protected with proper authentication and authorization checks regardless of URL obfuscation
- Unprotected admin panels are a critical access control vulnerability that can lead to vertical privilege escalation
- Server-side access controls should be implemented even when URLs are not easily guessable

## References

- [PortSwigger - Access Control](https://portswigger.net/web-security/access-control)
