# Authentication - Username Enumeration via Different Responses

## ğŸ“‹ Overview

**Lab:** Username enumeration via different responses  
**Platform:** PortSwigger Web Security Academy  
**Difficulty:** APPRENTICE  
**Category:** Authentication

## ğŸ¯ Objective

This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the provided wordlists.

To solve the lab, enumerate a valid username, brute-force this user's password, then access their account page.

## ğŸ” Reconnaissance

### Initial Analysis

The application's login functionality responds differently when a valid username is provided versus an invalid one. This difference in response behavior allows for username enumeration attacks.

### Target Endpoint

```
https://0ade004b03b0428584f8066f000000d2.web-security-academy.net/login
```

## ğŸ› ï¸ Exploitation

### Step 1: Intercept Login Request

I performed a test login request to `/login` and intercepted it using Burp Suite. The request was captured in the HTTP history for further analysis.

### Step 2: Username Enumeration with Burp Intruder

I sent the intercepted login request to Burp Intruder, which is essential for this enumeration attack. I configured Intruder to test the username parameter with the provided wordlist of candidate usernames.

**Request Configuration:**

```
POST /login HTTP/1.1
Host: 0ade004b03b0428584f8066f000000d2.web-security-academy.net
...
username=Â§PAYLOADÂ§&password=test
```

**Payload:** List of candidate usernames from the wordlist

### Step 3: Analyze Response Lengths

After running the Intruder attack, I analyzed the response lengths. Most responses had identical lengths, but one username stood out with a different response length: `atlas`.

This difference in response length indicated that `atlas` is a valid username, as the application returned a different response when the username exists (likely an "Invalid password" message) compared to when the username doesn't exist.

### Step 4: Verify Username Enumeration

I manually tested the username `atlas` on the login page and confirmed it exists by receiving an "Invalid password" message, which validated the enumeration result.

### Step 5: Password Brute-Force Attack

With the confirmed username `atlas`, I configured a new Intruder attack to brute-force the password parameter:

**Request Configuration:**

```
POST /login HTTP/1.1
Host: 0ade004b03b0428584f8066f000000d2.web-security-academy.net
...
username=atlas&password=Â§PAYLOADÂ§
```

**Payload:** List of candidate passwords from the wordlist

### Step 6: Identify Valid Password

After running the password brute-force attack, I analyzed the response lengths again. One password had a significantly different response length: `summer` with a length of 187 bytes, which was clearly discrepant from the other responses (most were around 3250-3337 bytes).

The different response length for `summer` indicated a successful login attempt, as the application likely redirected to a different page (status code 302) instead of showing an error message.

## âœ… Solution

### Final Credentials

```
Username: atlas
Password: summer
```

### Verification

After logging in with the credentials `atlas:summer`, I successfully accessed the account page and received the following confirmation:

```
My Account
Your username is: atlas
Your email is: atlas@normal-user.net
```

The lab was successfully completed, demonstrating that the application was vulnerable to username enumeration through different response behaviors and password brute-force attacks.

## ğŸ“¸ Screenshots

![Burp Suite Intruder results showing password enumeration with 'summer' having a different response length](./screenshots/image1.png)

## ğŸ” Key Takeaways

- Username enumeration vulnerabilities occur when applications respond differently to valid vs invalid usernames
- Response length analysis is an effective technique for identifying enumeration opportunities
- Burp Suite Intruder is an essential tool for automating enumeration and brute-force attacks
- Applications should return consistent error messages for both invalid usernames and invalid passwords to prevent enumeration
- Rate limiting and account lockout mechanisms can help mitigate brute-force attacks

## ğŸ“š References

- [PortSwigger - Authentication](https://portswigger.net/web-security/authentication)
- [PortSwigger - Username Enumeration](https://portswigger.net/web-security/authentication/password-based#username-enumeration)
